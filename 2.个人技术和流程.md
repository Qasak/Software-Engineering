## 单元测试

让模块的质量得到稳定，量化的保证

写技术模块的规格说明书(Specification)的时候，要越详细越好，最好各项要求都可以表示为一个单元测试用例

如果不能表示为一个单元测试用例，说明写得不够详细

### 好的单元测试

+ 最基本的功能/参数上验证程序的正确性

  单元测试要测试API中的每一个方法及每一个参数

+ 单元测试必须由最熟悉代码的人(程序作者)写

+ 单元测试后，机器状态不变

  若创建了临时文件或目录，应在Teardown阶段删掉

+ 单元测试要快(一个测试几秒)

+ 单元测试应产生可重复，一致的结果

+ 独立性

  不依赖别的测试

+ 覆盖所有代码路径

  包括错误处理路径，保证覆盖率，必须测试公开的和私有的函数/方法

### 100%覆盖率≠100%正确性

1. "应该写而没写的代码"：
   + 申请内存/其他资源，没有释放
   + 没有处理错误情况
2. 代码效率低
3. 多线程环境的同步问题，这和代码的执行时序，共享资源的锁定有关
4. "覆盖率"的层次：
   + 函数的覆盖
   + 语句的覆盖
   + 分支的覆盖
   + 条件的覆盖(这个模块的每一个布尔表达式都覆盖了吗？)

### 单元测试应集成到自动测试框架中

团队一般在每日构建之后运行单元测试，这样单元测试的错误就能及时发现并修改

### 单元测试必须和产品代码一起保存和维护

若不是，过一阵，代码和单元测试就会不一致，程序员要花时间确认哪些是程序出现的错误，哪些是单元测试滞后造成的错误

## 回归测试







